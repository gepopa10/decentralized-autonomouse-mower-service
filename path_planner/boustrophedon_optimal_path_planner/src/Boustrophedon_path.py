import numpy as np
import matplotlib.pyplot as plt
from Decomposition import Cell
from math import sqrt
from copy import deepcopy
import pickle
import sys
import numpy
from pprint import pprint
numpy.set_printoptions(threshold=sys.maxsize)

def Boustrophedon_path(cell, horizontal_direction, vertical_direction, robot_radius, plot = False, color = None, width = None) :
    current_x = min(cell.min_x + robot_radius, cell.max_x) # do we need to put cell.max_x - robot_radius ???
    finish = False
    path = [] # actual points to follow for each cell
    obstacle_position_x = -1
    max_ite = int((cell.max_x - cell.min_x)/robot_radius)
    for _ in range(max_ite) :
        if finish:
            break

        min_y = min(max(cell.floor[current_x] + robot_radius, cell.floor[current_x + robot_radius] + robot_radius), min(cell.ceiling[current_x + robot_radius], cell.ceiling[current_x])) # cell.ceiling[current_x + robot_radius] we do + robot_radius to be sure we dont enter in a corner
        max_y = max(max(cell.floor[current_x], cell.floor[current_x + robot_radius]), min(cell.ceiling[current_x + robot_radius] - robot_radius, cell.ceiling[current_x] - robot_radius))

        if vertical_direction == "UP" :
            path.append((current_x, min_y)) # we only append 2 points from the beggining to the end of line
            path.append((current_x, max_y))
            vertical_direction = "DOWN"
        else :
            path.append((current_x, max_y))
            path.append((current_x, min_y))
            vertical_direction = "UP"

        if current_x + robot_radius < cell.max_x :
            next_x = min(current_x + robot_radius * 2, cell.max_x)
            if next_x + robot_radius < cell.max_x :

                # This for loop is to make sure we dont go to close to obstacle when for next path line
                for col in range(current_x, current_x + robot_radius * 2):
                    if obstacle_position_x == col: # if its the same obstacle like last time we dont want to consider it again
                        continue

                    num_false = cell.ceiling[col] - cell.floor[col]
                    num_false_after = cell.ceiling[col+1] - cell.floor[col+1]

                    if abs(num_false_after-num_false) > robot_radius: # we found a corner
                        obstacle_position_x = col

                        if vertical_direction == "DOWN" :
                            index_first_obstacle = cell.ceiling[col]
                        else :
                            index_first_obstacle = cell.ceiling[col+1]

                        if cell.ceiling[current_x + robot_radius * 2] > index_first_obstacle: # this should be if x = current_x + robot_radius * 2 is in cell.ceiling[x] > first obstacle position
                            next_x = col
                        else:
                            next_x = col - robot_radius
                            if next_x < cell.min_x + robot_radius or vertical_direction == "UP":
                                next_x = current_x + 2*robot_radius

                        break # break because we found an obstacle and have our next x

                for x in range(current_x + 1, next_x) : # in x we have a lot of points but in y just 2 pts
                    if current_x < obstacle_position_x < next_x and vertical_direction == "DOWN":
                        forward_verification = robot_radius
                    else:
                        forward_verification = 0

                    if vertical_direction == "UP" :
                        y = min(cell.floor[x + forward_verification] + robot_radius, cell.ceiling[x])
                    else :
                        y = max(cell.ceiling[x + forward_verification] - robot_radius, cell.floor[x])

                    path.append((x, y))

                current_x = next_x
            else :
                finish = True
        else :
            finish = True


    if horizontal_direction == "LEFT" :
        path.reverse()

    path_length = 0.0
    for i in range(1, len(path)) :
        A = np.asarray(path[i - 1])
        B = np.asarray(path[i])
        path_length += np.sqrt(np.sum((B - A) ** 2))

    start_point = path[0]
    end_point = path[-1]

    # discretize the path when there are straight line
    discretize_path = []
    for i in range(len(path)-1):
        dist = sqrt((path[i+1][0] - path[i][0])**2 + (path[i+1][1] - path[i][1])**2)
        if dist > 2: #more than 2 pixels we need to add intermediate points
            nb_points = int(dist) - 1 # we want a point at each pixel
            new_points_y = np.linspace(path[i][1], path[i+1][1], nb_points)
            for idx in range(0,len(new_points_y)-1) : # we dont want to put the last point
                discretize_path.append((path[i][0], new_points_y[idx])) # x is the same while y varies
        else:
            discretize_path.append(path[i])

    discretize_path.append(path[i+1])
    path = discretize_path

    if plot :
        plt.plot(start_point[0], start_point[1], marker = 'o', color = 'orange', markersize = width + 6.4, zorder = 5)

        for i in range(len(path)) :
            if i == 0 or abs(path[i][1] - path[i - 1][1]) <= 1 :
                plt.plot(path[i][0], path[i][1], marker = 's', color = color, markersize = width, zorder = 2)
                # plt.scatter(path[i][0], path[i][1], color = 'r')
                # plt.annotate(i, path[i])
            else :
                # test case 1 : width + 1.6
                plt.plot([path[i - 1][0], path[i][0]], [path[i - 1][1], path[i][1]], color = color, linewidth = width + 1.6, zorder = 2)

        plt.plot(end_point[0], end_point[1], marker = 'X', color = 'mediumseagreen', markersize = width + 6.4, zorder = 5)

    return start_point, end_point, path_length, path


if __name__ == "__main__" :
    # TO PRINT ALL WITHOUT ... #################################################
    # import numpy
    # import sys
    # numpy.set_printoptions(threshold=sys.maxsize)
    ############################################################################

    dpi = 2000 # should be the same as in permimeter.py
    W, H = dpi, dpi

    my_dpi = 100
    fig = plt.figure(figsize = (W / my_dpi, H / my_dpi), dpi = my_dpi, frameon = False)
    ax = plt.Axes(fig, [0., 0., 1., 1.])
    ax.set_axis_off()
    fig.add_axes(ax)

    decomposed, total_cells_number, cells = pickle.load(open("data_files/decomposed_result", "rb")) # decomposed is the binary images 2d list

    # show decomposed result
    decomposed_image = np.zeros([H, W, 3], dtype = np.uint8)
    decomposed_image[decomposed > 0, :] = [255, 255, 255] # white
    plt.imshow(decomposed_image)
    ax.set_autoscale_on(False)

    cell = Cell()

    NUM_CELL_TEST = 4
    CELL_TEST_CASE = "Cell" + str(NUM_CELL_TEST)


    # Cell 1 ###################################################################
    ############################################################################
    if CELL_TEST_CASE == "Cell1":
        horizontal_direction = "RIGHT"
        vertical_direction = "UP"

        cell.max_x = 1554 # about end x
        cell.min_x = 1393 # about start x
        cell.points = 185501

        lower = 436 # about start y
        upper = 1638 # about end y
        cell.right = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        lower = 436
        upper = 1472
        cell.left = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        lower = 1393 # 1393:436
        upper = 1554 # 1554:436
        variable = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]
        const = 436
        for num in variable:
            cell.floor[num] = const

        cell.center = (1473, 1037)

        cell.ceiling = {1393: 1472, # this is probably the bottom x:y
                        1394: 1472,
                        1395: 1472,
                        1396: 1472,
                        1397: 1472,
                        1398: 1472,
                        1399: 1472,
                        1400: 1472,
                        1401: 1472,
                        1402: 1472,
                        1403: 1472,
                        1404: 1472,
                        1405: 1472,
                        1406: 1472,
                        1407: 1472,
                        1408: 1472,
                        1409: 1472,
                        1410: 1472,
                        1411: 1472,
                        1412: 1472,
                        1413: 1472,
                        1414: 1472,
                        1415: 1472,
                        1416: 1472,
                        1417: 1472,
                        1418: 1472,
                        1419: 1472,
                        1420: 1472,
                        1421: 1472,
                        1422: 1472,
                        1423: 1472,
                        1424: 1472,
                        1425: 1472,
                        1426: 1472,
                        1427: 1472,
                        1428: 1472,
                        1429: 1472,
                        1430: 1472,
                        1431: 1472,
                        1432: 1472,
                        1433: 1472,
                        1434: 1472,
                        1435: 1472,
                        1436: 1472,
                        1437: 1472,
                        1438: 1472,
                        1439: 1472,
                        1440: 1472,
                        1441: 1472,
                        1442: 1472,
                        1443: 1472,
                        1444: 1472,
                        1445: 1472,
                        1446: 1472,
                        1447: 1472,
                        1448: 1472,
                        1449: 1472,
                        1450: 1472,
                        1451: 1472,
                        1452: 1472,
                        1453: 1472,
                        1454: 1472,
                        1455: 1472,
                        1456: 1472,
                        1457: 1472,
                        1458: 1472,
                        1459: 1472,
                        1460: 1472,
                        1461: 1472,
                        1462: 1472,
                        1463: 1472,
                        1464: 1638,
                        1465: 1638,
                        1466: 1638,
                        1467: 1638,
                        1468: 1638,
                        1469: 1638,
                        1470: 1638,
                        1471: 1638,
                        1472: 1638,
                        1473: 1638,
                        1474: 1638,
                        1475: 1638,
                        1476: 1638,
                        1477: 1638,
                        1478: 1638,
                        1479: 1638,
                        1480: 1638,
                        1481: 1638,
                        1482: 1638,
                        1483: 1638,
                        1484: 1638,
                        1485: 1638,
                        1486: 1638,
                        1487: 1638,
                        1488: 1638,
                        1489: 1638,
                        1490: 1638,
                        1491: 1638,
                        1492: 1638,
                        1493: 1638,
                        1494: 1638,
                        1495: 1638,
                        1496: 1638,
                        1497: 1638,
                        1498: 1638,
                        1499: 1638,
                        1500: 1638,
                        1501: 1638,
                        1502: 1638,
                        1503: 1638,
                        1504: 1638,
                        1505: 1638,
                        1506: 1638,
                        1507: 1638,
                        1508: 1638,
                        1509: 1638,
                        1510: 1638,
                        1511: 1638,
                        1512: 1638,
                        1513: 1638,
                        1514: 1638,
                        1515: 1638,
                        1516: 1638,
                        1517: 1638,
                        1518: 1638,
                        1519: 1638,
                        1520: 1638,
                        1521: 1638,
                        1522: 1638,
                        1523: 1638,
                        1524: 1638,
                        1525: 1638,
                        1526: 1638,
                        1527: 1638,
                        1528: 1638,
                        1529: 1638,
                        1530: 1638,
                        1531: 1638,
                        1532: 1638,
                        1533: 1638,
                        1534: 1638,
                        1535: 1638,
                        1536: 1638,
                        1537: 1638,
                        1538: 1638,
                        1539: 1638,
                        1540: 1638,
                        1541: 1638,
                        1542: 1638,
                        1543: 1638,
                        1544: 1638,
                        1545: 1638,
                        1546: 1638,
                        1547: 1638,
                        1548: 1638,
                        1549: 1638,
                        1550: 1638,
                        1551: 1638,
                        1552: 1638,
                        1553: 1638,
                        1554: 1638}

        # END Cell 1 ###############################################################
        ############################################################################

    # Cell 2 ###################################################################
    ############################################################################ 1392: 868
    elif (CELL_TEST_CASE == "Cell2"):
        horizontal_direction = "LEFT"
        vertical_direction = "UP"
        cell.max_x = 1392 # about end x
        cell.min_x = 978 # about start x
        cell.points = 209219

        lower = 868 # about start y
        upper = 1472 # about end y
        cell.right = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        lower = 1124
        upper = 1558
        cell.left = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        cell.ceiling = {978: 1558,
                        979: 1558,
                        980: 1558,
                        981: 1558,
                        982: 1558,
                        983: 1558,
                        984: 1558,
                        985: 1558,
                        986: 1558,
                        987: 1558,
                        988: 1558,
                        989: 1558,
                        990: 1558,
                        991: 1558,
                        992: 1558,
                        993: 1558,
                        994: 1558,
                        995: 1558,
                        996: 1558,
                        997: 1558,
                        998: 1558,
                        999: 1558,
                        1000: 1558,
                        1001: 1558,
                        1002: 1558,
                        1003: 1558,
                        1004: 1558,
                        1005: 1558,
                        1006: 1558,
                        1007: 1558,
                        1008: 1558,
                        1009: 1558,
                        1010: 1558,
                        1011: 1558,
                        1012: 1558,
                        1013: 1558,
                        1014: 1558,
                        1015: 1558,
                        1016: 1558,
                        1017: 1558,
                        1018: 1558,
                        1019: 1558,
                        1020: 1558,
                        1021: 1558,
                        1022: 1558,
                        1023: 1558,
                        1024: 1558,
                        1025: 1558,
                        1026: 1558,
                        1027: 1558,
                        1028: 1558,
                        1029: 1558,
                        1030: 1558,
                        1031: 1558,
                        1032: 1558,
                        1033: 1558,
                        1034: 1558,
                        1035: 1558,
                        1036: 1558,
                        1037: 1558,
                        1038: 1558,
                        1039: 1558,
                        1040: 1558,
                        1041: 1558,
                        1042: 1558,
                        1043: 1558,
                        1044: 1558,
                        1045: 1558,
                        1046: 1558,
                        1047: 1558,
                        1048: 1558,
                        1049: 1558,
                        1050: 1558,
                        1051: 1558,
                        1052: 1558,
                        1053: 1558,
                        1054: 1558,
                        1055: 1558,
                        1056: 1558,
                        1057: 1558,
                        1058: 1558,
                        1059: 1558,
                        1060: 1558,
                        1061: 1558,
                        1062: 1558,
                        1063: 1558,
                        1064: 1558,
                        1065: 1558,
                        1066: 1558,
                        1067: 1558,
                        1068: 1558,
                        1069: 1558,
                        1070: 1558,
                        1071: 1558,
                        1072: 1472,
                        1073: 1472,
                        1074: 1472,
                        1075: 1472,
                        1076: 1472,
                        1077: 1472,
                        1078: 1472,
                        1079: 1472,
                        1080: 1472,
                        1081: 1472,
                        1082: 1472,
                        1083: 1472,
                        1084: 1472,
                        1085: 1472,
                        1086: 1472,
                        1087: 1472,
                        1088: 1472,
                        1089: 1472,
                        1090: 1472,
                        1091: 1472,
                        1092: 1472,
                        1093: 1472,
                        1094: 1472,
                        1095: 1472,
                        1096: 1472,
                        1097: 1472,
                        1098: 1472,
                        1099: 1472,
                        1100: 1472,
                        1101: 1472,
                        1102: 1472,
                        1103: 1472,
                        1104: 1472,
                        1105: 1472,
                        1106: 1472,
                        1107: 1472,
                        1108: 1472,
                        1109: 1472,
                        1110: 1472,
                        1111: 1472,
                        1112: 1472,
                        1113: 1472,
                        1114: 1472,
                        1115: 1472,
                        1116: 1472,
                        1117: 1472,
                        1118: 1472,
                        1119: 1472,
                        1120: 1472,
                        1121: 1472,
                        1122: 1472,
                        1123: 1472,
                        1124: 1472,
                        1125: 1472,
                        1126: 1472,
                        1127: 1472,
                        1128: 1472,
                        1129: 1472,
                        1130: 1472,
                        1131: 1472,
                        1132: 1472,
                        1133: 1472,
                        1134: 1472,
                        1135: 1472,
                        1136: 1472,
                        1137: 1472,
                        1138: 1472,
                        1139: 1472,
                        1140: 1472,
                        1141: 1472,
                        1142: 1472,
                        1143: 1472,
                        1144: 1472,
                        1145: 1472,
                        1146: 1472,
                        1147: 1472,
                        1148: 1472,
                        1149: 1472,
                        1150: 1472,
                        1151: 1472,
                        1152: 1472,
                        1153: 1472,
                        1154: 1472,
                        1155: 1472,
                        1156: 1472,
                        1157: 1472,
                        1158: 1472,
                        1159: 1472,
                        1160: 1472,
                        1161: 1472,
                        1162: 1472,
                        1163: 1472,
                        1164: 1472,
                        1165: 1472,
                        1166: 1472,
                        1167: 1472,
                        1168: 1472,
                        1169: 1472,
                        1170: 1472,
                        1171: 1472,
                        1172: 1472,
                        1173: 1472,
                        1174: 1472,
                        1175: 1472,
                        1176: 1472,
                        1177: 1472,
                        1178: 1472,
                        1179: 1472,
                        1180: 1472,
                        1181: 1472,
                        1182: 1472,
                        1183: 1472,
                        1184: 1472,
                        1185: 1472,
                        1186: 1472,
                        1187: 1472,
                        1188: 1472,
                        1189: 1472,
                        1190: 1472,
                        1191: 1472,
                        1192: 1472,
                        1193: 1472,
                        1194: 1472,
                        1195: 1472,
                        1196: 1472,
                        1197: 1472,
                        1198: 1472,
                        1199: 1472,
                        1200: 1472,
                        1201: 1472,
                        1202: 1472,
                        1203: 1472,
                        1204: 1472,
                        1205: 1472,
                        1206: 1472,
                        1207: 1472,
                        1208: 1472,
                        1209: 1472,
                        1210: 1472,
                        1211: 1472,
                        1212: 1472,
                        1213: 1472,
                        1214: 1472,
                        1215: 1472,
                        1216: 1472,
                        1217: 1472,
                        1218: 1472,
                        1219: 1472,
                        1220: 1472,
                        1221: 1472,
                        1222: 1472,
                        1223: 1472,
                        1224: 1472,
                        1225: 1472,
                        1226: 1472,
                        1227: 1472,
                        1228: 1472,
                        1229: 1472,
                        1230: 1472,
                        1231: 1472,
                        1232: 1472,
                        1233: 1472,
                        1234: 1472,
                        1235: 1472,
                        1236: 1472,
                        1237: 1472,
                        1238: 1472,
                        1239: 1472,
                        1240: 1472,
                        1241: 1472,
                        1242: 1472,
                        1243: 1472,
                        1244: 1472,
                        1245: 1472,
                        1246: 1472,
                        1247: 1472,
                        1248: 1472,
                        1249: 1472,
                        1250: 1472,
                        1251: 1472,
                        1252: 1472,
                        1253: 1472,
                        1254: 1472,
                        1255: 1472,
                        1256: 1472,
                        1257: 1472,
                        1258: 1472,
                        1259: 1472,
                        1260: 1472,
                        1261: 1472,
                        1262: 1472,
                        1263: 1472,
                        1264: 1472,
                        1265: 1472,
                        1266: 1472,
                        1267: 1472,
                        1268: 1472,
                        1269: 1472,
                        1270: 1472,
                        1271: 1472,
                        1272: 1472,
                        1273: 1472,
                        1274: 1472,
                        1275: 1472,
                        1276: 1472,
                        1277: 1472,
                        1278: 1472,
                        1279: 1472,
                        1280: 1472,
                        1281: 1472,
                        1282: 1472,
                        1283: 1472,
                        1284: 1472,
                        1285: 1472,
                        1286: 1472,
                        1287: 1472,
                        1288: 1472,
                        1289: 1472,
                        1290: 1472,
                        1291: 1472,
                        1292: 1472,
                        1293: 1472,
                        1294: 1472,
                        1295: 1472,
                        1296: 1472,
                        1297: 1472,
                        1298: 1472,
                        1299: 1472,
                        1300: 1472,
                        1301: 1472,
                        1302: 1472,
                        1303: 1472,
                        1304: 1472,
                        1305: 1472,
                        1306: 1472,
                        1307: 1472,
                        1308: 1472,
                        1309: 1472,
                        1310: 1472,
                        1311: 1472,
                        1312: 1472,
                        1313: 1472,
                        1314: 1472,
                        1315: 1472,
                        1316: 1472,
                        1317: 1472,
                        1318: 1472,
                        1319: 1472,
                        1320: 1472,
                        1321: 1472,
                        1322: 1472,
                        1323: 1472,
                        1324: 1472,
                        1325: 1472,
                        1326: 1472,
                        1327: 1472,
                        1328: 1472,
                        1329: 1472,
                        1330: 1472,
                        1331: 1472,
                        1332: 1472,
                        1333: 1472,
                        1334: 1472,
                        1335: 1472,
                        1336: 1472,
                        1337: 1472,
                        1338: 1472,
                        1339: 1472,
                        1340: 1472,
                        1341: 1472,
                        1342: 1472,
                        1343: 1472,
                        1344: 1472,
                        1345: 1472,
                        1346: 1472,
                        1347: 1472,
                        1348: 1472,
                        1349: 1472,
                        1350: 1472,
                        1351: 1472,
                        1352: 1472,
                        1353: 1472,
                        1354: 1472,
                        1355: 1472,
                        1356: 1472,
                        1357: 1472,
                        1358: 1472,
                        1359: 1472,
                        1360: 1472,
                        1361: 1472,
                        1362: 1472,
                        1363: 1472,
                        1364: 1472,
                        1365: 1472,
                        1366: 1472,
                        1367: 1472,
                        1368: 1472,
                        1369: 1472,
                        1370: 1472,
                        1371: 1472,
                        1372: 1472,
                        1373: 1472,
                        1374: 1472,
                        1375: 1472,
                        1376: 1472,
                        1377: 1472,
                        1378: 1472,
                        1379: 1472,
                        1380: 1472,
                        1381: 1472,
                        1382: 1472,
                        1383: 1472,
                        1384: 1472,
                        1385: 1472,
                        1386: 1472,
                        1387: 1472,
                        1388: 1472,
                        1389: 1472,
                        1390: 1472,
                        1391: 1472,
                        1392: 1472}

        cell.center = (1185, 1232)

        cell.floor = {  978: 1124,
                        979: 1123,
                        980: 1122,
                        981: 1121,
                        982: 1120,
                        983: 1119,
                        984: 1117,
                        985: 1116,
                        986: 1115,
                        987: 1114,
                        988: 1113,
                        989: 1112,
                        990: 1111,
                        991: 1109,
                        992: 1108,
                        993: 1107,
                        994: 1106,
                        995: 1105,
                        996: 1104,
                        997: 1102,
                        998: 1101,
                        999: 1100,
                        1000: 1099,
                        1001: 1098,
                        1002: 1097,
                        1003: 1095,
                        1004: 1094,
                        1005: 1093,
                        1006: 1092,
                        1007: 1091,
                        1008: 1090,
                        1009: 1089,
                        1010: 1087,
                        1011: 1086,
                        1012: 1085,
                        1013: 1084,
                        1014: 1083,
                        1015: 1082,
                        1016: 1080,
                        1017: 1079,
                        1018: 1078,
                        1019: 1077,
                        1020: 1076,
                        1021: 1075,
                        1022: 1074,
                        1023: 1072,
                        1024: 1071,
                        1025: 1070,
                        1026: 1069,
                        1027: 1068,
                        1028: 1067,
                        1029: 1065,
                        1030: 1064,
                        1031: 1063,
                        1032: 1062,
                        1033: 1061,
                        1034: 1060,
                        1035: 1058,
                        1036: 1057,
                        1037: 1056,
                        1038: 1055,
                        1039: 1054,
                        1040: 1053,
                        1041: 1052,
                        1042: 1050,
                        1043: 1049,
                        1044: 1048,
                        1045: 1047,
                        1046: 1046,
                        1047: 1045,
                        1048: 1043,
                        1049: 1042,
                        1050: 1041,
                        1051: 1040,
                        1052: 1039,
                        1053: 1038,
                        1054: 1036,
                        1055: 1035,
                        1056: 1034,
                        1057: 1033,
                        1058: 1032,
                        1059: 1031,
                        1060: 1029,
                        1061: 1028,
                        1062: 1027,
                        1063: 1026,
                        1064: 1025,
                        1065: 1024,
                        1066: 1023,
                        1067: 1021,
                        1068: 1020,
                        1069: 1019,
                        1070: 1018,
                        1071: 1017,
                        1072: 1016,
                        1073: 1014,
                        1074: 1013,
                        1075: 1012,
                        1076: 1011,
                        1077: 1010,
                        1078: 1009,
                        1079: 1007,
                        1080: 1006,
                        1081: 1005,
                        1082: 1004,
                        1083: 1003,
                        1084: 1002,
                        1085: 1001,
                        1086: 999,
                        1087: 998,
                        1088: 997,
                        1089: 996,
                        1090: 995,
                        1091: 994,
                        1092: 993,
                        1093: 993,
                        1094: 993,
                        1095: 993,
                        1096: 993,
                        1097: 993,
                        1098: 993,
                        1099: 993,
                        1100: 993,
                        1101: 993,
                        1102: 993,
                        1103: 993,
                        1104: 993,
                        1105: 993,
                        1106: 993,
                        1107: 993,
                        1108: 993,
                        1109: 993,
                        1110: 993,
                        1111: 993,
                        1112: 993,
                        1113: 993,
                        1114: 993,
                        1115: 993,
                        1116: 993,
                        1117: 993,
                        1118: 993,
                        1119: 993,
                        1120: 993,
                        1121: 993,
                        1122: 993,
                        1123: 993,
                        1124: 993,
                        1125: 993,
                        1126: 993,
                        1127: 993,
                        1128: 993,
                        1129: 993,
                        1130: 993,
                        1131: 993,
                        1132: 993,
                        1133: 993,
                        1134: 993,
                        1135: 993,
                        1136: 993,
                        1137: 993,
                        1138: 993,
                        1139: 993,
                        1140: 993,
                        1141: 993,
                        1142: 993,
                        1143: 993,
                        1144: 993,
                        1145: 993,
                        1146: 993,
                        1147: 993,
                        1148: 993,
                        1149: 993,
                        1150: 993,
                        1151: 993,
                        1152: 993,
                        1153: 993,
                        1154: 993,
                        1155: 993,
                        1156: 993,
                        1157: 993,
                        1158: 993,
                        1159: 993,
                        1160: 993,
                        1161: 993,
                        1162: 993,
                        1163: 993,
                        1164: 993,
                        1165: 993,
                        1166: 993,
                        1167: 993,
                        1168: 993,
                        1169: 993,
                        1170: 993,
                        1171: 993,
                        1172: 993,
                        1173: 993,
                        1174: 993,
                        1175: 993,
                        1176: 993,
                        1177: 993,
                        1178: 993,
                        1179: 993,
                        1180: 993,
                        1181: 993,
                        1182: 993,
                        1183: 993,
                        1184: 993,
                        1185: 993,
                        1186: 993,
                        1187: 993,
                        1188: 993,
                        1189: 993,
                        1190: 993,
                        1191: 993,
                        1192: 993,
                        1193: 993,
                        1194: 993,
                        1195: 993,
                        1196: 993,
                        1197: 993,
                        1198: 993,
                        1199: 993,
                        1200: 993,
                        1201: 993,
                        1202: 993,
                        1203: 993,
                        1204: 993,
                        1205: 993,
                        1206: 993,
                        1207: 993,
                        1208: 993,
                        1209: 993,
                        1210: 993,
                        1211: 993,
                        1212: 993,
                        1213: 993,
                        1214: 993,
                        1215: 993,
                        1216: 993,
                        1217: 993,
                        1218: 993,
                        1219: 993,
                        1220: 993,
                        1221: 993,
                        1222: 993,
                        1223: 993,
                        1224: 993,
                        1225: 993,
                        1226: 993,
                        1227: 993,
                        1228: 993,
                        1229: 993,
                        1230: 993,
                        1231: 993,
                        1232: 993,
                        1233: 993,
                        1234: 993,
                        1235: 993,
                        1236: 993,
                        1237: 993,
                        1238: 993,
                        1239: 993,
                        1240: 993,
                        1241: 993,
                        1242: 993,
                        1243: 993,
                        1244: 993,
                        1245: 993,
                        1246: 993,
                        1247: 993,
                        1248: 993,
                        1249: 993,
                        1250: 993,
                        1251: 993,
                        1252: 993,
                        1253: 993,
                        1254: 993,
                        1255: 993,
                        1256: 993,
                        1257: 993,
                        1258: 993,
                        1259: 993,
                        1260: 993,
                        1261: 993,
                        1262: 993,
                        1263: 993,
                        1264: 993,
                        1265: 993,
                        1266: 993,
                        1267: 993,
                        1268: 993,
                        1269: 992,
                        1270: 991,
                        1271: 990,
                        1272: 989,
                        1273: 988,
                        1274: 987,
                        1275: 986,
                        1276: 985,
                        1277: 984,
                        1278: 983,
                        1279: 982,
                        1280: 981,
                        1281: 980,
                        1282: 979,
                        1283: 978,
                        1284: 977,
                        1285: 976,
                        1286: 975,
                        1287: 974,
                        1288: 973,
                        1289: 972,
                        1290: 971,
                        1291: 970,
                        1292: 969,
                        1293: 968,
                        1294: 967,
                        1295: 966,
                        1296: 965,
                        1297: 964,
                        1298: 963,
                        1299: 962,
                        1300: 961,
                        1301: 960,
                        1302: 959,
                        1303: 958,
                        1304: 957,
                        1305: 956,
                        1306: 955,
                        1307: 954,
                        1308: 953,
                        1309: 952,
                        1310: 951,
                        1311: 950,
                        1312: 949,
                        1313: 948,
                        1314: 947,
                        1315: 946,
                        1316: 945,
                        1317: 944,
                        1318: 943,
                        1319: 942,
                        1320: 941,
                        1321: 940,
                        1322: 939,
                        1323: 938,
                        1324: 937,
                        1325: 936,
                        1326: 935,
                        1327: 934,
                        1328: 933,
                        1329: 932,
                        1330: 931,
                        1331: 930,
                        1332: 929,
                        1333: 928,
                        1334: 927,
                        1335: 926,
                        1336: 925,
                        1337: 924,
                        1338: 923,
                        1339: 922,
                        1340: 921,
                        1341: 920,
                        1342: 919,
                        1343: 918,
                        1344: 917,
                        1345: 916,
                        1346: 915,
                        1347: 914,
                        1348: 913,
                        1349: 912,
                        1350: 911,
                        1351: 910,
                        1352: 909,
                        1353: 908,
                        1354: 907,
                        1355: 906,
                        1356: 905,
                        1357: 904,
                        1358: 903,
                        1359: 902,
                        1360: 901,
                        1361: 900,
                        1362: 899,
                        1363: 898,
                        1364: 897,
                        1365: 896,
                        1366: 895,
                        1367: 894,
                        1368: 893,
                        1369: 892,
                        1370: 891,
                        1371: 890,
                        1372: 889,
                        1373: 888,
                        1374: 887,
                        1375: 886,
                        1376: 885,
                        1377: 884,
                        1378: 883,
                        1379: 882,
                        1380: 881,
                        1381: 880,
                        1382: 879,
                        1383: 878,
                        1384: 877,
                        1385: 876,
                        1386: 875,
                        1387: 874,
                        1388: 873,
                        1389: 872,
                        1390: 871,
                        1391: 870,
                        1392: 868}

        # END Cell 2 ###########################################################
        ########################################################################

    # Cell 3 ###################################################################
    ############################################################################
    elif CELL_TEST_CASE == "Cell3":
        horizontal_direction = "LEFT"
        vertical_direction = "UP"
        cell.max_x = 547 # about end x
        cell.min_x = 208 # about start x
        cell.points = 221559

        lower = 745 # about start y
        upper = 1472 # about end y
        cell.right = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        lower = 578
        upper = 1708
        cell.left = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        cell.center = (377, 1170)

        cell.ceiling = {208: 1708,
                        209: 1708,
                        210: 1708,
                        211: 1708,
                        212: 1708,
                        213: 1708,
                        214: 1708,
                        215: 1708,
                        216: 1708,
                        217: 1707,
                        218: 1707,
                        219: 1707,
                        220: 1707,
                        221: 1707,
                        222: 1707,
                        223: 1707,
                        224: 1707,
                        225: 1472,
                        226: 1472,
                        227: 1472,
                        228: 1472,
                        229: 1472,
                        230: 1472,
                        231: 1472,
                        232: 1472,
                        233: 1472,
                        234: 1472,
                        235: 1472,
                        236: 1472,
                        237: 1472,
                        238: 1472,
                        239: 1472,
                        240: 1472,
                        241: 1472,
                        242: 1472,
                        243: 1472,
                        244: 1472,
                        245: 1472,
                        246: 1472,
                        247: 1472,
                        248: 1472,
                        249: 1472,
                        250: 1472,
                        251: 1472,
                        252: 1472,
                        253: 1472,
                        254: 1472,
                        255: 1472,
                        256: 1472,
                        257: 1472,
                        258: 1472,
                        259: 1472,
                        260: 1472,
                        261: 1472,
                        262: 1472,
                        263: 1472,
                        264: 1472,
                        265: 1472,
                        266: 1472,
                        267: 1472,
                        268: 1472,
                        269: 1472,
                        270: 1472,
                        271: 1472,
                        272: 1472,
                        273: 1472,
                        274: 1472,
                        275: 1472,
                        276: 1472,
                        277: 1472,
                        278: 1472,
                        279: 1472,
                        280: 1472,
                        281: 1472,
                        282: 1472,
                        283: 1472,
                        284: 1472,
                        285: 1472,
                        286: 1472,
                        287: 1472,
                        288: 1472,
                        289: 1472,
                        290: 1472,
                        291: 1472,
                        292: 1472,
                        293: 1472,
                        294: 1472,
                        295: 1472,
                        296: 1472,
                        297: 1472,
                        298: 1472,
                        299: 1472,
                        300: 1472,
                        301: 1472,
                        302: 1472,
                        303: 1472,
                        304: 1472,
                        305: 1472,
                        306: 1472,
                        307: 1472,
                        308: 1472,
                        309: 1472,
                        310: 1472,
                        311: 1472,
                        312: 1472,
                        313: 1472,
                        314: 1472,
                        315: 1472,
                        316: 1472,
                        317: 1472,
                        318: 1472,
                        319: 1472,
                        320: 1472,
                        321: 1472,
                        322: 1472,
                        323: 1472,
                        324: 1472,
                        325: 1472,
                        326: 1472,
                        327: 1472,
                        328: 1472,
                        329: 1472,
                        330: 1472,
                        331: 1472,
                        332: 1472,
                        333: 1472,
                        334: 1472,
                        335: 1472,
                        336: 1472,
                        337: 1472,
                        338: 1472,
                        339: 1472,
                        340: 1472,
                        341: 1472,
                        342: 1472,
                        343: 1472,
                        344: 1472,
                        345: 1472,
                        346: 1472,
                        347: 1472,
                        348: 1472,
                        349: 1472,
                        350: 1472,
                        351: 1472,
                        352: 1472,
                        353: 1472,
                        354: 1472,
                        355: 1472,
                        356: 1472,
                        357: 1472,
                        358: 1472,
                        359: 1472,
                        360: 1472,
                        361: 1472,
                        362: 1472,
                        363: 1472,
                        364: 1472,
                        365: 1472,
                        366: 1472,
                        367: 1472,
                        368: 1472,
                        369: 1472,
                        370: 1472,
                        371: 1472,
                        372: 1472,
                        373: 1472,
                        374: 1472,
                        375: 1472,
                        376: 1472,
                        377: 1472,
                        378: 1472,
                        379: 1472,
                        380: 1472,
                        381: 1472,
                        382: 1472,
                        383: 1472,
                        384: 1472,
                        385: 1472,
                        386: 1472,
                        387: 1472,
                        388: 1472,
                        389: 1472,
                        390: 1472,
                        391: 1472,
                        392: 1472,
                        393: 1472,
                        394: 1472,
                        395: 1472,
                        396: 1472,
                        397: 1472,
                        398: 1472,
                        399: 1472,
                        400: 1472,
                        401: 1472,
                        402: 1472,
                        403: 1472,
                        404: 1472,
                        405: 1472,
                        406: 1472,
                        407: 1472,
                        408: 1472,
                        409: 1472,
                        410: 1472,
                        411: 1472,
                        412: 1472,
                        413: 1472,
                        414: 1472,
                        415: 1472,
                        416: 1472,
                        417: 1472,
                        418: 1472,
                        419: 1472,
                        420: 1472,
                        421: 1472,
                        422: 1472,
                        423: 1472,
                        424: 1472,
                        425: 1472,
                        426: 1472,
                        427: 1472,
                        428: 1472,
                        429: 1472,
                        430: 1472,
                        431: 1472,
                        432: 1472,
                        433: 1472,
                        434: 1472,
                        435: 1472,
                        436: 1472,
                        437: 1472,
                        438: 1472,
                        439: 1472,
                        440: 1472,
                        441: 1472,
                        442: 1472,
                        443: 1472,
                        444: 1472,
                        445: 1472,
                        446: 1472,
                        447: 1472,
                        448: 1472,
                        449: 1472,
                        450: 1472,
                        451: 1472,
                        452: 1472,
                        453: 1472,
                        454: 1472,
                        455: 1472,
                        456: 1472,
                        457: 1472,
                        458: 1472,
                        459: 1472,
                        460: 1472,
                        461: 1472,
                        462: 1472,
                        463: 1472,
                        464: 1472,
                        465: 1472,
                        466: 1472,
                        467: 1472,
                        468: 1472,
                        469: 1472,
                        470: 1472,
                        471: 1472,
                        472: 1472,
                        473: 1472,
                        474: 1472,
                        475: 1472,
                        476: 1472,
                        477: 1472,
                        478: 1472,
                        479: 1472,
                        480: 1472,
                        481: 1472,
                        482: 1472,
                        483: 1472,
                        484: 1472,
                        485: 1472,
                        486: 1472,
                        487: 1472,
                        488: 1472,
                        489: 1472,
                        490: 1472,
                        491: 1472,
                        492: 1472,
                        493: 1472,
                        494: 1472,
                        495: 1472,
                        496: 1472,
                        497: 1472,
                        498: 1472,
                        499: 1472,
                        500: 1472,
                        501: 1472,
                        502: 1472,
                        503: 1472,
                        504: 1472,
                        505: 1472,
                        506: 1472,
                        507: 1472,
                        508: 1472,
                        509: 1472,
                        510: 1472,
                        511: 1472,
                        512: 1472,
                        513: 1472,
                        514: 1472,
                        515: 1472,
                        516: 1472,
                        517: 1472,
                        518: 1472,
                        519: 1472,
                        520: 1472,
                        521: 1472,
                        522: 1472,
                        523: 1472,
                        524: 1472,
                        525: 1472,
                        526: 1472,
                        527: 1472,
                        528: 1472,
                        529: 1472,
                        530: 1472,
                        531: 1472,
                        532: 1472,
                        533: 1472,
                        534: 1472,
                        535: 1472,
                        536: 1472,
                        537: 1472,
                        538: 1472,
                        539: 1472,
                        540: 1472,
                        541: 1472,
                        542: 1472,
                        543: 1472,
                        544: 1472,
                        545: 1472,
                        546: 1472,
                        547: 1472}

        cell.floor = {  208: 578,
                        209: 587,
                        210: 596,
                        211: 604,
                        212: 613,
                        213: 621,
                        214: 630,
                        215: 638,
                        216: 647,
                        217: 655,
                        218: 664,
                        219: 672,
                        220: 681,
                        221: 689,
                        222: 698,
                        223: 706,
                        224: 715,
                        225: 724,
                        226: 732,
                        227: 741,
                        228: 749,
                        229: 758,
                        230: 766,
                        231: 775,
                        232: 783,
                        233: 792,
                        234: 800,
                        235: 809,
                        236: 817,
                        237: 826,
                        238: 835,
                        239: 843,
                        240: 852,
                        241: 860,
                        242: 869,
                        243: 877,
                        244: 886,
                        245: 894,
                        246: 903,
                        247: 911,
                        248: 920,
                        249: 928,
                        250: 937,
                        251: 946,
                        252: 954,
                        253: 957,
                        254: 957,
                        255: 956,
                        256: 955,
                        257: 954,
                        258: 954,
                        259: 953,
                        260: 952,
                        261: 952,
                        262: 951,
                        263: 950,
                        264: 949,
                        265: 949,
                        266: 948,
                        267: 947,
                        268: 947,
                        269: 946,
                        270: 945,
                        271: 944,
                        272: 944,
                        273: 943,
                        274: 942,
                        275: 941,
                        276: 941,
                        277: 940,
                        278: 939,
                        279: 939,
                        280: 938,
                        281: 937,
                        282: 936,
                        283: 936,
                        284: 935,
                        285: 934,
                        286: 934,
                        287: 933,
                        288: 932,
                        289: 931,
                        290: 931,
                        291: 930,
                        292: 929,
                        293: 929,
                        294: 928,
                        295: 927,
                        296: 926,
                        297: 926,
                        298: 925,
                        299: 924,
                        300: 923,
                        301: 923,
                        302: 922,
                        303: 921,
                        304: 921,
                        305: 920,
                        306: 919,
                        307: 918,
                        308: 918,
                        309: 917,
                        310: 916,
                        311: 916,
                        312: 915,
                        313: 914,
                        314: 913,
                        315: 913,
                        316: 912,
                        317: 911,
                        318: 910,
                        319: 910,
                        320: 909,
                        321: 908,
                        322: 908,
                        323: 907,
                        324: 906,
                        325: 905,
                        326: 905,
                        327: 904,
                        328: 903,
                        329: 903,
                        330: 902,
                        331: 901,
                        332: 900,
                        333: 900,
                        334: 899,
                        335: 898,
                        336: 898,
                        337: 897,
                        338: 896,
                        339: 895,
                        340: 895,
                        341: 894,
                        342: 893,
                        343: 892,
                        344: 892,
                        345: 891,
                        346: 890,
                        347: 890,
                        348: 889,
                        349: 888,
                        350: 887,
                        351: 887,
                        352: 886,
                        353: 885,
                        354: 885,
                        355: 884,
                        356: 883,
                        357: 882,
                        358: 882,
                        359: 881,
                        360: 880,
                        361: 879,
                        362: 879,
                        363: 878,
                        364: 877,
                        365: 877,
                        366: 876,
                        367: 875,
                        368: 874,
                        369: 874,
                        370: 873,
                        371: 872,
                        372: 872,
                        373: 871,
                        374: 870,
                        375: 869,
                        376: 869,
                        377: 868,
                        378: 867,
                        379: 866,
                        380: 866,
                        381: 865,
                        382: 864,
                        383: 864,
                        384: 863,
                        385: 862,
                        386: 861,
                        387: 861,
                        388: 860,
                        389: 859,
                        390: 859,
                        391: 858,
                        392: 857,
                        393: 856,
                        394: 856,
                        395: 855,
                        396: 854,
                        397: 854,
                        398: 853,
                        399: 852,
                        400: 851,
                        401: 851,
                        402: 850,
                        403: 849,
                        404: 848,
                        405: 848,
                        406: 847,
                        407: 846,
                        408: 846,
                        409: 845,
                        410: 844,
                        411: 843,
                        412: 843,
                        413: 842,
                        414: 841,
                        415: 841,
                        416: 840,
                        417: 839,
                        418: 838,
                        419: 838,
                        420: 837,
                        421: 836,
                        422: 835,
                        423: 835,
                        424: 834,
                        425: 833,
                        426: 833,
                        427: 832,
                        428: 831,
                        429: 830,
                        430: 830,
                        431: 829,
                        432: 828,
                        433: 828,
                        434: 827,
                        435: 826,
                        436: 825,
                        437: 825,
                        438: 824,
                        439: 823,
                        440: 823,
                        441: 822,
                        442: 821,
                        443: 820,
                        444: 820,
                        445: 819,
                        446: 818,
                        447: 817,
                        448: 817,
                        449: 816,
                        450: 815,
                        451: 815,
                        452: 814,
                        453: 813,
                        454: 812,
                        455: 812,
                        456: 811,
                        457: 810,
                        458: 810,
                        459: 809,
                        460: 808,
                        461: 807,
                        462: 807,
                        463: 806,
                        464: 805,
                        465: 804,
                        466: 804,
                        467: 803,
                        468: 802,
                        469: 802,
                        470: 801,
                        471: 800,
                        472: 799,
                        473: 799,
                        474: 798,
                        475: 797,
                        476: 797,
                        477: 796,
                        478: 795,
                        479: 794,
                        480: 794,
                        481: 793,
                        482: 792,
                        483: 792,
                        484: 791,
                        485: 790,
                        486: 789,
                        487: 789,
                        488: 788,
                        489: 787,
                        490: 786,
                        491: 786,
                        492: 785,
                        493: 784,
                        494: 784,
                        495: 783,
                        496: 782,
                        497: 781,
                        498: 781,
                        499: 780,
                        500: 779,
                        501: 779,
                        502: 778,
                        503: 777,
                        504: 776,
                        505: 776,
                        506: 775,
                        507: 774,
                        508: 773,
                        509: 773,
                        510: 772,
                        511: 771,
                        512: 771,
                        513: 770,
                        514: 769,
                        515: 768,
                        516: 768,
                        517: 767,
                        518: 766,
                        519: 766,
                        520: 765,
                        521: 764,
                        522: 763,
                        523: 763,
                        524: 762,
                        525: 761,
                        526: 760,
                        527: 760,
                        528: 759,
                        529: 758,
                        530: 758,
                        531: 757,
                        532: 756,
                        533: 755,
                        534: 755,
                        535: 754,
                        536: 753,
                        537: 753,
                        538: 752,
                        539: 751,
                        540: 750,
                        541: 750,
                        542: 749,
                        543: 748,
                        544: 748,
                        545: 747,
                        546: 746,
                        547: 745}

        # END Cell 3 ###########################################################
        ########################################################################

    # Cell 4 ###################################################################
    ############################################################################
    elif CELL_TEST_CASE == "Cell4":
        horizontal_direction = "LEFT"
        vertical_direction = "UP"
        cell.max_x = 1392 # about end x
        cell.min_x = 737 # about start x
        cell.points = 133133

        lower = 436 # about start y
        upper = 632 # about end y
        cell.right = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        lower = 435
        upper = 1000
        cell.left = [lower + x*(upper-lower)/(upper-lower) for x in range(upper-lower+1)]

        cell.center = (1064, 471)

        cell.ceiling = {737: 1000,
             738: 999,
             739: 998,
             740: 997,
             741: 996,
             742: 995,
             743: 994,
             744: 993,
             745: 992,
             746: 990,
             747: 989,
             748: 988,
             749: 987,
             750: 986,
             751: 985,
             752: 984,
             753: 983,
             754: 982,
             755: 980,
             756: 979,
             757: 978,
             758: 977,
             759: 976,
             760: 975,
             761: 974,
             762: 973,
             763: 972,
             764: 970,
             765: 969,
             766: 968,
             767: 967,
             768: 966,
             769: 965,
             770: 964,
             771: 963,
             772: 962,
             773: 960,
             774: 959,
             775: 958,
             776: 957,
             777: 956,
             778: 955,
             779: 954,
             780: 953,
             781: 952,
             782: 950,
             783: 949,
             784: 948,
             785: 947,
             786: 946,
             787: 945,
             788: 944,
             789: 943,
             790: 942,
             791: 940,
             792: 939,
             793: 938,
             794: 937,
             795: 936,
             796: 935,
             797: 934,
             798: 933,
             799: 932,
             800: 930,
             801: 929,
             802: 928,
             803: 927,
             804: 926,
             805: 925,
             806: 924,
             807: 923,
             808: 922,
             809: 920,
             810: 919,
             811: 918,
             812: 917,
             813: 916,
             814: 915,
             815: 914,
             816: 913,
             817: 912,
             818: 910,
             819: 909,
             820: 908,
             821: 907,
             822: 906,
             823: 905,
             824: 904,
             825: 903,
             826: 902,
             827: 900,
             828: 899,
             829: 898,
             830: 897,
             831: 896,
             832: 895,
             833: 894,
             834: 893,
             835: 892,
             836: 890,
             837: 889,
             838: 888,
             839: 887,
             840: 886,
             841: 885,
             842: 884,
             843: 883,
             844: 882,
             845: 880,
             846: 879,
             847: 878,
             848: 877,
             849: 876,
             850: 875,
             851: 874,
             852: 873,
             853: 872,
             854: 870,
             855: 869,
             856: 868,
             857: 867,
             858: 866,
             859: 865,
             860: 864,
             861: 863,
             862: 862,
             863: 860,
             864: 859,
             865: 858,
             866: 857,
             867: 856,
             868: 855,
             869: 854,
             870: 853,
             871: 852,
             872: 850,
             873: 849,
             874: 848,
             875: 847,
             876: 846,
             877: 845,
             878: 844,
             879: 843,
             880: 842,
             881: 840,
             882: 839,
             883: 838,
             884: 837,
             885: 836,
             886: 835,
             887: 834,
             888: 833,
             889: 832,
             890: 830,
             891: 829,
             892: 828,
             893: 827,
             894: 826,
             895: 825,
             896: 824,
             897: 823,
             898: 822,
             899: 820,
             900: 819,
             901: 818,
             902: 817,
             903: 816,
             904: 815,
             905: 814,
             906: 813,
             907: 812,
             908: 755,
             909: 631,
             910: 630,
             911: 629,
             912: 628,
             913: 627,
             914: 626,
             915: 625,
             916: 624,
             917: 623,
             918: 622,
             919: 621,
             920: 620,
             921: 619,
             922: 618,
             923: 617,
             924: 616,
             925: 615,
             926: 614,
             927: 613,
             928: 612,
             929: 611,
             930: 610,
             931: 609,
             932: 608,
             933: 607,
             934: 606,
             935: 605,
             936: 604,
             937: 603,
             938: 601,
             939: 600,
             940: 599,
             941: 598,
             942: 597,
             943: 596,
             944: 595,
             945: 594,
             946: 593,
             947: 592,
             948: 591,
             949: 590,
             950: 589,
             951: 588,
             952: 587,
             953: 586,
             954: 585,
             955: 584,
             956: 583,
             957: 582,
             958: 581,
             959: 580,
             960: 579,
             961: 578,
             962: 577,
             963: 576,
             964: 575,
             965: 574,
             966: 573,
             967: 572,
             968: 570,
             969: 569,
             970: 568,
             971: 567,
             972: 566,
             973: 565,
             974: 564,
             975: 563,
             976: 562,
             977: 561,
             978: 560,
             979: 559,
             980: 558,
             981: 557,
             982: 556,
             983: 555,
             984: 554,
             985: 553,
             986: 552,
             987: 551,
             988: 550,
             989: 549,
             990: 548,
             991: 547,
             992: 546,
             993: 545,
             994: 544,
             995: 543,
             996: 542,
             997: 541,
             998: 539,
             999: 538,
             1000: 537,
             1001: 536,
             1002: 535,
             1003: 534,
             1004: 533,
             1005: 532,
             1006: 531,
             1007: 530,
             1008: 529,
             1009: 528,
             1010: 527,
             1011: 526,
             1012: 525,
             1013: 524,
             1014: 523,
             1015: 522,
             1016: 521,
             1017: 520,
             1018: 519,
             1019: 518,
             1020: 517,
             1021: 516,
             1022: 515,
             1023: 514,
             1024: 513,
             1025: 512,
             1026: 511,
             1027: 510,
             1028: 509,
             1029: 508,
             1030: 508,
             1031: 508,
             1032: 508,
             1033: 508,
             1034: 508,
             1035: 508,
             1036: 508,
             1037: 508,
             1038: 508,
             1039: 508,
             1040: 508,
             1041: 508,
             1042: 508,
             1043: 508,
             1044: 508,
             1045: 508,
             1046: 508,
             1047: 508,
             1048: 508,
             1049: 508,
             1050: 508,
             1051: 508,
             1052: 508,
             1053: 508,
             1054: 508,
             1055: 508,
             1056: 508,
             1057: 508,
             1058: 508,
             1059: 508,
             1060: 508,
             1061: 508,
             1062: 508,
             1063: 508,
             1064: 508,
             1065: 508,
             1066: 508,
             1067: 508,
             1068: 508,
             1069: 508,
             1070: 508,
             1071: 508,
             1072: 508,
             1073: 508,
             1074: 508,
             1075: 508,
             1076: 508,
             1077: 508,
             1078: 508,
             1079: 508,
             1080: 508,
             1081: 508,
             1082: 508,
             1083: 508,
             1084: 508,
             1085: 508,
             1086: 508,
             1087: 508,
             1088: 508,
             1089: 508,
             1090: 508,
             1091: 508,
             1092: 508,
             1093: 508,
             1094: 508,
             1095: 508,
             1096: 508,
             1097: 508,
             1098: 508,
             1099: 508,
             1100: 508,
             1101: 508,
             1102: 508,
             1103: 508,
             1104: 508,
             1105: 508,
             1106: 508,
             1107: 508,
             1108: 508,
             1109: 508,
             1110: 508,
             1111: 508,
             1112: 508,
             1113: 508,
             1114: 508,
             1115: 508,
             1116: 508,
             1117: 508,
             1118: 508,
             1119: 508,
             1120: 508,
             1121: 508,
             1122: 508,
             1123: 508,
             1124: 508,
             1125: 508,
             1126: 508,
             1127: 508,
             1128: 508,
             1129: 508,
             1130: 508,
             1131: 508,
             1132: 508,
             1133: 508,
             1134: 508,
             1135: 508,
             1136: 508,
             1137: 508,
             1138: 508,
             1139: 508,
             1140: 508,
             1141: 508,
             1142: 508,
             1143: 508,
             1144: 508,
             1145: 508,
             1146: 508,
             1147: 508,
             1148: 508,
             1149: 508,
             1150: 508,
             1151: 508,
             1152: 508,
             1153: 508,
             1154: 508,
             1155: 508,
             1156: 508,
             1157: 508,
             1158: 508,
             1159: 508,
             1160: 508,
             1161: 508,
             1162: 508,
             1163: 508,
             1164: 508,
             1165: 508,
             1166: 508,
             1167: 508,
             1168: 508,
             1169: 508,
             1170: 508,
             1171: 508,
             1172: 508,
             1173: 508,
             1174: 508,
             1175: 508,
             1176: 508,
             1177: 508,
             1178: 508,
             1179: 508,
             1180: 508,
             1181: 508,
             1182: 508,
             1183: 508,
             1184: 508,
             1185: 508,
             1186: 508,
             1187: 508,
             1188: 508,
             1189: 508,
             1190: 508,
             1191: 508,
             1192: 508,
             1193: 508,
             1194: 508,
             1195: 508,
             1196: 508,
             1197: 508,
             1198: 508,
             1199: 508,
             1200: 508,
             1201: 508,
             1202: 508,
             1203: 508,
             1204: 508,
             1205: 508,
             1206: 508,
             1207: 508,
             1208: 508,
             1209: 508,
             1210: 508,
             1211: 508,
             1212: 508,
             1213: 508,
             1214: 508,
             1215: 508,
             1216: 508,
             1217: 508,
             1218: 508,
             1219: 508,
             1220: 508,
             1221: 508,
             1222: 508,
             1223: 508,
             1224: 508,
             1225: 508,
             1226: 508,
             1227: 508,
             1228: 508,
             1229: 508,
             1230: 508,
             1231: 508,
             1232: 508,
             1233: 508,
             1234: 508,
             1235: 508,
             1236: 508,
             1237: 508,
             1238: 508,
             1239: 508,
             1240: 508,
             1241: 508,
             1242: 508,
             1243: 508,
             1244: 508,
             1245: 508,
             1246: 508,
             1247: 508,
             1248: 508,
             1249: 508,
             1250: 508,
             1251: 508,
             1252: 508,
             1253: 508,
             1254: 508,
             1255: 508,
             1256: 508,
             1257: 508,
             1258: 508,
             1259: 508,
             1260: 508,
             1261: 508,
             1262: 508,
             1263: 508,
             1264: 508,
             1265: 508,
             1266: 508,
             1267: 508,
             1268: 509,
             1269: 509,
             1270: 510,
             1271: 511,
             1272: 512,
             1273: 513,
             1274: 514,
             1275: 515,
             1276: 516,
             1277: 517,
             1278: 518,
             1279: 519,
             1280: 520,
             1281: 521,
             1282: 522,
             1283: 523,
             1284: 524,
             1285: 525,
             1286: 526,
             1287: 527,
             1288: 528,
             1289: 529,
             1290: 530,
             1291: 531,
             1292: 532,
             1293: 533,
             1294: 534,
             1295: 535,
             1296: 536,
             1297: 537,
             1298: 538,
             1299: 539,
             1300: 540,
             1301: 541,
             1302: 542,
             1303: 543,
             1304: 544,
             1305: 545,
             1306: 546,
             1307: 547,
             1308: 548,
             1309: 549,
             1310: 550,
             1311: 551,
             1312: 552,
             1313: 553,
             1314: 554,
             1315: 555,
             1316: 556,
             1317: 557,
             1318: 558,
             1319: 559,
             1320: 560,
             1321: 561,
             1322: 562,
             1323: 563,
             1324: 564,
             1325: 565,
             1326: 566,
             1327: 567,
             1328: 568,
             1329: 569,
             1330: 570,
             1331: 571,
             1332: 572,
             1333: 573,
             1334: 574,
             1335: 575,
             1336: 576,
             1337: 577,
             1338: 578,
             1339: 579,
             1340: 580,
             1341: 581,
             1342: 582,
             1343: 583,
             1344: 584,
             1345: 585,
             1346: 586,
             1347: 587,
             1348: 588,
             1349: 589,
             1350: 590,
             1351: 591,
             1352: 592,
             1353: 593,
             1354: 594,
             1355: 595,
             1356: 596,
             1357: 597,
             1358: 598,
             1359: 599,
             1360: 600,
             1361: 601,
             1362: 602,
             1363: 603,
             1364: 604,
             1365: 605,
             1366: 606,
             1367: 607,
             1368: 608,
             1369: 609,
             1370: 610,
             1371: 611,
             1372: 612,
             1373: 613,
             1374: 614,
             1375: 615,
             1376: 616,
             1377: 617,
             1378: 618,
             1379: 619,
             1380: 620,
             1381: 621,
             1382: 622,
             1383: 623,
             1384: 624,
             1385: 625,
             1386: 626,
             1387: 627,
             1388: 628,
             1389: 629,
             1390: 629,
             1391: 630,
             1392: 632}

        cell.floor = {737: 435,
           738: 435,
           739: 435,
           740: 435,
           741: 435,
           742: 435,
           743: 435,
           744: 435,
           745: 435,
           746: 435,
           747: 435,
           748: 435,
           749: 435,
           750: 435,
           751: 435,
           752: 435,
           753: 435,
           754: 435,
           755: 435,
           756: 435,
           757: 435,
           758: 435,
           759: 435,
           760: 435,
           761: 435,
           762: 435,
           763: 435,
           764: 435,
           765: 435,
           766: 435,
           767: 435,
           768: 435,
           769: 435,
           770: 435,
           771: 435,
           772: 435,
           773: 435,
           774: 435,
           775: 435,
           776: 435,
           777: 435,
           778: 435,
           779: 435,
           780: 435,
           781: 435,
           782: 435,
           783: 435,
           784: 435,
           785: 435,
           786: 435,
           787: 435,
           788: 435,
           789: 435,
           790: 435,
           791: 435,
           792: 435,
           793: 435,
           794: 435,
           795: 435,
           796: 435,
           797: 435,
           798: 435,
           799: 435,
           800: 435,
           801: 435,
           802: 435,
           803: 435,
           804: 435,
           805: 435,
           806: 435,
           807: 435,
           808: 435,
           809: 435,
           810: 435,
           811: 435,
           812: 435,
           813: 435,
           814: 435,
           815: 435,
           816: 435,
           817: 435,
           818: 435,
           819: 435,
           820: 435,
           821: 435,
           822: 435,
           823: 435,
           824: 435,
           825: 435,
           826: 435,
           827: 435,
           828: 435,
           829: 435,
           830: 435,
           831: 435,
           832: 435,
           833: 435,
           834: 435,
           835: 435,
           836: 435,
           837: 435,
           838: 435,
           839: 435,
           840: 435,
           841: 435,
           842: 435,
           843: 435,
           844: 435,
           845: 435,
           846: 435,
           847: 435,
           848: 435,
           849: 435,
           850: 435,
           851: 435,
           852: 435,
           853: 435,
           854: 435,
           855: 435,
           856: 435,
           857: 435,
           858: 435,
           859: 435,
           860: 435,
           861: 435,
           862: 435,
           863: 435,
           864: 435,
           865: 435,
           866: 435,
           867: 435,
           868: 435,
           869: 435,
           870: 435,
           871: 435,
           872: 435,
           873: 435,
           874: 435,
           875: 435,
           876: 435,
           877: 435,
           878: 435,
           879: 435,
           880: 435,
           881: 435,
           882: 435,
           883: 435,
           884: 435,
           885: 435,
           886: 435,
           887: 435,
           888: 435,
           889: 435,
           890: 435,
           891: 435,
           892: 435,
           893: 435,
           894: 435,
           895: 435,
           896: 435,
           897: 435,
           898: 435,
           899: 435,
           900: 435,
           901: 435,
           902: 435,
           903: 435,
           904: 435,
           905: 435,
           906: 435,
           907: 435,
           908: 435,
           909: 435,
           910: 435,
           911: 435,
           912: 435,
           913: 435,
           914: 435,
           915: 435,
           916: 435,
           917: 435,
           918: 435,
           919: 435,
           920: 435,
           921: 435,
           922: 435,
           923: 435,
           924: 435,
           925: 435,
           926: 435,
           927: 435,
           928: 435,
           929: 435,
           930: 435,
           931: 435,
           932: 435,
           933: 435,
           934: 435,
           935: 435,
           936: 435,
           937: 435,
           938: 435,
           939: 435,
           940: 435,
           941: 435,
           942: 435,
           943: 435,
           944: 435,
           945: 435,
           946: 435,
           947: 435,
           948: 435,
           949: 435,
           950: 435,
           951: 435,
           952: 435,
           953: 435,
           954: 435,
           955: 435,
           956: 435,
           957: 435,
           958: 435,
           959: 435,
           960: 435,
           961: 435,
           962: 435,
           963: 435,
           964: 435,
           965: 435,
           966: 435,
           967: 435,
           968: 435,
           969: 435,
           970: 435,
           971: 435,
           972: 435,
           973: 435,
           974: 435,
           975: 435,
           976: 435,
           977: 435,
           978: 435,
           979: 435,
           980: 435,
           981: 435,
           982: 435,
           983: 435,
           984: 435,
           985: 435,
           986: 435,
           987: 435,
           988: 435,
           989: 435,
           990: 435,
           991: 435,
           992: 435,
           993: 435,
           994: 435,
           995: 435,
           996: 435,
           997: 435,
           998: 435,
           999: 435,
           1000: 435,
           1001: 435,
           1002: 435,
           1003: 435,
           1004: 435,
           1005: 435,
           1006: 435,
           1007: 435,
           1008: 435,
           1009: 435,
           1010: 435,
           1011: 435,
           1012: 435,
           1013: 435,
           1014: 435,
           1015: 435,
           1016: 435,
           1017: 435,
           1018: 435,
           1019: 435,
           1020: 435,
           1021: 435,
           1022: 435,
           1023: 435,
           1024: 435,
           1025: 435,
           1026: 435,
           1027: 435,
           1028: 435,
           1029: 435,
           1030: 435,
           1031: 435,
           1032: 435,
           1033: 435,
           1034: 435,
           1035: 435,
           1036: 435,
           1037: 435,
           1038: 435,
           1039: 435,
           1040: 435,
           1041: 435,
           1042: 435,
           1043: 435,
           1044: 435,
           1045: 435,
           1046: 435,
           1047: 435,
           1048: 435,
           1049: 435,
           1050: 435,
           1051: 435,
           1052: 435,
           1053: 435,
           1054: 435,
           1055: 435,
           1056: 435,
           1057: 435,
           1058: 435,
           1059: 435,
           1060: 435,
           1061: 435,
           1062: 435,
           1063: 435,
           1064: 435,
           1065: 435,
           1066: 435,
           1067: 435,
           1068: 435,
           1069: 435,
           1070: 435,
           1071: 435,
           1072: 436,
           1073: 436,
           1074: 436,
           1075: 436,
           1076: 436,
           1077: 436,
           1078: 436,
           1079: 436,
           1080: 436,
           1081: 436,
           1082: 436,
           1083: 436,
           1084: 436,
           1085: 436,
           1086: 436,
           1087: 436,
           1088: 436,
           1089: 436,
           1090: 436,
           1091: 436,
           1092: 436,
           1093: 436,
           1094: 436,
           1095: 436,
           1096: 436,
           1097: 436,
           1098: 436,
           1099: 436,
           1100: 436,
           1101: 436,
           1102: 436,
           1103: 436,
           1104: 436,
           1105: 436,
           1106: 436,
           1107: 436,
           1108: 436,
           1109: 436,
           1110: 436,
           1111: 436,
           1112: 436,
           1113: 436,
           1114: 436,
           1115: 436,
           1116: 436,
           1117: 436,
           1118: 436,
           1119: 436,
           1120: 436,
           1121: 436,
           1122: 436,
           1123: 436,
           1124: 436,
           1125: 436,
           1126: 436,
           1127: 436,
           1128: 436,
           1129: 436,
           1130: 436,
           1131: 436,
           1132: 436,
           1133: 436,
           1134: 436,
           1135: 436,
           1136: 436,
           1137: 436,
           1138: 436,
           1139: 436,
           1140: 436,
           1141: 436,
           1142: 436,
           1143: 436,
           1144: 436,
           1145: 436,
           1146: 436,
           1147: 436,
           1148: 436,
           1149: 436,
           1150: 436,
           1151: 436,
           1152: 436,
           1153: 436,
           1154: 436,
           1155: 436,
           1156: 436,
           1157: 436,
           1158: 436,
           1159: 436,
           1160: 436,
           1161: 436,
           1162: 436,
           1163: 436,
           1164: 436,
           1165: 436,
           1166: 436,
           1167: 436,
           1168: 436,
           1169: 436,
           1170: 436,
           1171: 436,
           1172: 436,
           1173: 436,
           1174: 436,
           1175: 436,
           1176: 436,
           1177: 436,
           1178: 436,
           1179: 436,
           1180: 436,
           1181: 436,
           1182: 436,
           1183: 436,
           1184: 436,
           1185: 436,
           1186: 436,
           1187: 436,
           1188: 436,
           1189: 436,
           1190: 436,
           1191: 436,
           1192: 436,
           1193: 436,
           1194: 436,
           1195: 436,
           1196: 436,
           1197: 436,
           1198: 436,
           1199: 436,
           1200: 436,
           1201: 436,
           1202: 436,
           1203: 436,
           1204: 436,
           1205: 436,
           1206: 436,
           1207: 436,
           1208: 436,
           1209: 436,
           1210: 436,
           1211: 436,
           1212: 436,
           1213: 436,
           1214: 436,
           1215: 436,
           1216: 436,
           1217: 436,
           1218: 436,
           1219: 436,
           1220: 436,
           1221: 436,
           1222: 436,
           1223: 436,
           1224: 436,
           1225: 436,
           1226: 436,
           1227: 436,
           1228: 436,
           1229: 436,
           1230: 436,
           1231: 436,
           1232: 436,
           1233: 436,
           1234: 436,
           1235: 436,
           1236: 436,
           1237: 436,
           1238: 436,
           1239: 436,
           1240: 436,
           1241: 436,
           1242: 436,
           1243: 436,
           1244: 436,
           1245: 436,
           1246: 436,
           1247: 436,
           1248: 436,
           1249: 436,
           1250: 436,
           1251: 436,
           1252: 436,
           1253: 436,
           1254: 436,
           1255: 436,
           1256: 436,
           1257: 436,
           1258: 436,
           1259: 436,
           1260: 436,
           1261: 436,
           1262: 436,
           1263: 436,
           1264: 436,
           1265: 436,
           1266: 436,
           1267: 436,
           1268: 436,
           1269: 436,
           1270: 436,
           1271: 436,
           1272: 436,
           1273: 436,
           1274: 436,
           1275: 436,
           1276: 436,
           1277: 436,
           1278: 436,
           1279: 436,
           1280: 436,
           1281: 436,
           1282: 436,
           1283: 436,
           1284: 436,
           1285: 436,
           1286: 436,
           1287: 436,
           1288: 436,
           1289: 436,
           1290: 436,
           1291: 436,
           1292: 436,
           1293: 436,
           1294: 436,
           1295: 436,
           1296: 436,
           1297: 436,
           1298: 436,
           1299: 436,
           1300: 436,
           1301: 436,
           1302: 436,
           1303: 436,
           1304: 436,
           1305: 436,
           1306: 436,
           1307: 436,
           1308: 436,
           1309: 436,
           1310: 436,
           1311: 436,
           1312: 436,
           1313: 436,
           1314: 436,
           1315: 436,
           1316: 436,
           1317: 436,
           1318: 436,
           1319: 436,
           1320: 436,
           1321: 436,
           1322: 436,
           1323: 436,
           1324: 436,
           1325: 436,
           1326: 436,
           1327: 436,
           1328: 436,
           1329: 436,
           1330: 436,
           1331: 436,
           1332: 436,
           1333: 436,
           1334: 436,
           1335: 436,
           1336: 436,
           1337: 436,
           1338: 436,
           1339: 436,
           1340: 436,
           1341: 436,
           1342: 436,
           1343: 436,
           1344: 436,
           1345: 436,
           1346: 436,
           1347: 436,
           1348: 436,
           1349: 436,
           1350: 436,
           1351: 436,
           1352: 436,
           1353: 436,
           1354: 436,
           1355: 436,
           1356: 436,
           1357: 436,
           1358: 436,
           1359: 436,
           1360: 436,
           1361: 436,
           1362: 436,
           1363: 436,
           1364: 436,
           1365: 436,
           1366: 436,
           1367: 436,
           1368: 436,
           1369: 436,
           1370: 436,
           1371: 436,
           1372: 436,
           1373: 436,
           1374: 436,
           1375: 436,
           1376: 436,
           1377: 436,
           1378: 436,
           1379: 436,
           1380: 436,
           1381: 436,
           1382: 436,
           1383: 436,
           1384: 436,
           1385: 436,
           1386: 436,
           1387: 436,
           1388: 436,
           1389: 436,
           1390: 436,
           1391: 436,
           1392: 436}

        # END Cell 4 ###########################################################
        ########################################################################

    start_point, end_point, path_length, path = Boustrophedon_path(cell, horizontal_direction, vertical_direction, 14, plot = True, color = 'silver', width = 2)
    plt.show()
    print("start_point ", start_point, " end_point ", end_point, " path_length ", path_length)
